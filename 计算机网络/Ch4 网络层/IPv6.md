## IPv6 的特点

1. 更大的地址空间，使用 128 位地址
2. 扩展的地址层次结构
3. 灵活的首部格式
4. 改进的选项。**首部长度固定40B**，但是选项是灵活可变的
5. 允许协议继续扩充
6. 支持即插即用。不需要使用 [[动态主机配置协议 DHCP|DHCP]]
7. 支持资源的预分配
8. IPv6 只有源主机才能分片，是端到端的。**如果路由器收到的 IPv6 数据报太大，则会直接丢弃，并向发送方发送一个指示分组太大的 [[网际控制报文协议 ICMP|ICMP]] 报文**
9. 增加了安全性。首部有身份鉴别和保密功能
10. 取消了首部检验和
11. 配套的网际层协议只有 **ICMPv6**。ICMPv6 包含了 IPv4 中 ARP 和 IGMP 的功能

## IPv6 数据报的基本首部

![](https://img.mileomni.com/1731243009764.png)

![](https://img.mileomni.com/1731243009850.png)

| 字段               | 长度   | 描述                                                                  |
| ---------------- | ---- | ------------------------------------------------------------------- |
| 版本               | 4b   | 协议版本，IPv6 该字段的值是 6                                                  |
| 通信量类             | 8b   | 区分不同的 IPv6 数据报的类别或优先级                                               |
| 流标号              | 20b  | IPv6 提出“流”的抽象概念，同一个流的数据报都有相同的流标号                                    |
| 有效载荷长度           | 16b  | 除**基本首部**以外的字节数                                                     |
| 下一个首部            | 8b   | 当没有扩展首部时，作用与 [[IPv4]] 的协议字段一样，指明数据是何种协议数据单元；当有扩展首部时，它用来标识第一个扩展首部的类型 |
| 跳数限制 (Hop Limit) | 8b   | TTL                                                                 |
| 源地址和目的地址         | 128b | 发送端/接收端的 IP 地址                                                      |

## IPv6 地址

IPv6 数据报的目的地址除了单播和多播外，多了一个**任播**。任播的终点是一组计算机，但数据报只交付其中的一台计算机，通常是距离最近的一台计算机。

IPv6 标准使用**冒号十六进制表示法**，如 fe80::d2cd:916e:bf69:2313，一个地址的表示中，只能使用一次“::”缩写，因为要是出现两处缩写，就无法推断出地址了。

| 地址类型     | 二进制前缀     | 描述                                    |
| -------- | --------- | ------------------------------------- |
| 未指明地址    | ::/128    | 不能用作目的地址，只能用于还未配置 IPv6 的主机作为源地址       |
| 环回地址     | :: 1/128  | 和 [[IPv4]] 的环回地址作用相同，但是IPv6 的环回地址仅此一个 |
| 多播地址     | FF00::/8  | 和 [[IPv4]] 的多播地址作用相同                  |
| 本地链路单播地址 | FE80::/10 | 相当于 [[IPv4]] 的私有 IP 地址                |
| 全球单播地址   | 剩余其他所有地址  | 使用三级结构：48 位全球路由选择前缀；16 位子网标识符；64 位主机号 |

## IPv4 向 IPv6 过渡

1. 双协议栈，同时装有 [[IPv4]] 和 IPv6 两个协议栈
2. 隧道技术，将 IPv6 数据报封装成 [[IPv4]] 数据报的数据部分，这样可以支持不支持 IPv6 的网络

## 传输层的功能

传输层提供**点对点**的逻辑通信，也就是应用进程之间的逻辑通信。

### 复用和分用

复用：指发送方不同的应用进程都可以使用同一个传输层协议发送数据。
分用：指接收方的传输层在剥去报文的首部后能够把这些数据正确交付到目的应用进程。

## 检错检测

传输层对收到的报文（**首部和数据**）进行差错检测。对于 [[TCP]] 协议，若接收方发现报文段出错，则要求发送方**重发**该报文段。对于 [[UDP]] 协议，若接收方发现数据报出错，则直接**丢弃**。

>在网络层，IP 数据报首部的检验和字段只检验首部是否出错，并不检验数据部分。

### 提供面向连接和无连接的传输协议

面向连接的 [[TCP]] 协议：逻辑通信信道相当于一条全双工的可靠信道。
无连接的 [[UDP]] 协议：逻辑通信信道仍是一条不可靠信道。

## 传输层的寻址与端口

IP 地址标识主机，端口标识**主机中的应用进程**。

### 端口号

端口号长度为 16bit。端口号只具有本地意义，只标识本计算机应用层中的各进程。

| 端口号类型  | 范围          |
| ------ | ----------- |
| 熟知端口号  | 0~1023      |
| 登记端口号  | 1024~49151  |
| 客户端端口号 | 49152~65535 |

#### 服务端端口号

| 常用应用程序 | [[文件传输协议 FTP\|FTP]] | TELNET | SMTP | [[域名系统 DNS\|DNS]] | TFTP | HTTP | SNMP |
| ------ | ------------------- | ------ | ---- | ----------------- | ---- | ---- | ---- |
| 端口号    | 21                  | 23     | 25   | 53                | 69   | 80   | 161  |

#### 客户端端口号

客户端使用的端口号范围为 41952~65535。客户端端口号仅在客户端运行时才动态选择，所以又称**短暂端口号**。

### 套接字

套接字（Socket）=( IP : port )

**套接字唯一标识网络中的一台主机上的一个应用进程。**

## 无连接服务和面向连接服务

[[TCP]] 不提供广播或多播服务，主要用于**可靠性更重要的场合**，如文件传输协议 [[文件传输协议 FTP|FTP]]、超文本传输协议 HTTP、远程登陆 TELNET 等。

[[UDP]] 执行速度快，实时性好，主要用于如小文件传输协议 TFTP、[[域名系统 DNS|DNS]]、简单网络管理协议SNMP 和实时传输协议 RTP 等。

| 互联网应用     | TCP/IP 应用层协议            | TCP/IP 传输层协议 |     |
| --------- | ----------------------- | ------------ | --- |
| 域名解析      | [[域名系统 DNS\|DNS]]       | [[UDP]]      |     |
| 文件传送      | TFTP                    | [[UDP]]      |     |
| 路由选择      | RIP                     | [[UDP]]      |     |
| 网络参数配置    | [[动态主机配置协议 DHCP\|DHCP]] | [[UDP]]      |     |
| 网络管理      | SNMP                    | [[UDP]]      |     |
| [[IP 多播]] | IGMP                    | [[UDP]]      |     |
| [[电子邮件]]  | SMTP                    | [[TCP]]      |     |
| 远程终端接入    | TELNET                  | [[TCP]]      |     |
| 万维网       | HTTP                    | [[TCP]]      |     |
| 文件传送      | [[文件传输协议 FTP\|FTP]]     | [[TCP]]      |     |

> 网络层如果使用[[虚电路和数据报服务|虚电路]]，则无法提供无连接 [[UDP]]服务；但是传输层使用 [[TCP]] 不影响网络层提供无连接服务。
